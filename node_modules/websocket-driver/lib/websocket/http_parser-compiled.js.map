{"version":3,"sources":["http_parser.js"],"names":[],"mappings":"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","file":"http_parser-compiled.js","sourcesContent":["'use strict';\n\nvar NodeHTTPParser = process.binding('http_parser').HTTPParser,\n    version        = NodeHTTPParser.RESPONSE ? 6 : 4;\n\nvar HttpParser = function(type) {\n  if (type === 'request')\n    this._parser = new NodeHTTPParser(NodeHTTPParser.REQUEST || 'request');\n  else\n    this._parser = new NodeHTTPParser(NodeHTTPParser.RESPONSE || 'response');\n\n  this._type     = type;\n  this._complete = false;\n  this.headers   = {};\n\n  var current = null,\n      self    = this;\n\n  this._parser.onHeaderField = function(b, start, length) {\n    current = b.toString('utf8', start, start + length).toLowerCase();\n  };\n\n  this._parser.onHeaderValue = function(b, start, length) {\n    var value = b.toString('utf8', start, start + length);\n\n    if (self.headers.hasOwnProperty(current))\n      self.headers[current] += ', ' + value;\n    else\n      self.headers[current] = value;\n  };\n\n  this._parser.onHeadersComplete = this._parser[NodeHTTPParser.kOnHeadersComplete] =\n  function(majorVersion, minorVersion, headers, method, pathname, statusCode) {\n    var info = arguments[0];\n\n    if (typeof info === 'object') {\n      method     = info.method;\n      pathname   = info.url;\n      statusCode = info.statusCode;\n      headers    = info.headers;\n    }\n\n    self.method     = (typeof method === 'number') ? HttpParser.METHODS[method] : method;\n    self.statusCode = statusCode;\n    self.url        = pathname;\n\n    if (!headers) return;\n\n    for (var i = 0, n = headers.length, key, value; i < n; i += 2) {\n      key   = headers[i].toLowerCase();\n      value = headers[i+1];\n      if (self.headers.hasOwnProperty(key))\n        self.headers[key] += ', ' + value;\n      else\n        self.headers[key] = value;\n    }\n\n    self._complete = true;\n  };\n};\n\nHttpParser.METHODS = {\n  0:  'DELETE',\n  1:  'GET',\n  2:  'HEAD',\n  3:  'POST',\n  4:  'PUT',\n  5:  'CONNECT',\n  6:  'OPTIONS',\n  7:  'TRACE',\n  8:  'COPY',\n  9:  'LOCK',\n  10: 'MKCOL',\n  11: 'MOVE',\n  12: 'PROPFIND',\n  13: 'PROPPATCH',\n  14: 'SEARCH',\n  15: 'UNLOCK',\n  16: 'REPORT',\n  17: 'MKACTIVITY',\n  18: 'CHECKOUT',\n  19: 'MERGE',\n  24: 'PATCH'\n};\n\nHttpParser.prototype.isComplete = function() {\n  return this._complete;\n};\n\nHttpParser.prototype.parse = function(chunk) {\n  var offset   = (version < 6) ? 1 : 0,\n      consumed = this._parser.execute(chunk, 0, chunk.length) + offset;\n\n  if (this._complete)\n    this.body = (consumed < chunk.length)\n              ? chunk.slice(consumed)\n              : new Buffer(0);\n};\n\nmodule.exports = HttpParser;\n"]}