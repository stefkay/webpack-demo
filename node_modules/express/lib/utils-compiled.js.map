{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["/*!\n * express\n * Copyright(c) 2009-2013 TJ Holowaychuk\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module dependencies.\n * @api private\n */\n\nvar contentDisposition = require('content-disposition');\nvar contentType = require('content-type');\nvar deprecate = require('depd')('express');\nvar flatten = require('array-flatten');\nvar mime = require('send').mime;\nvar basename = require('path').basename;\nvar etag = require('etag');\nvar proxyaddr = require('proxy-addr');\nvar qs = require('qs');\nvar querystring = require('querystring');\n\n/**\n * Return strong ETag for `body`.\n *\n * @param {String|Buffer} body\n * @param {String} [encoding]\n * @return {String}\n * @api private\n */\n\nexports.etag = function (body, encoding) {\n  var buf = !Buffer.isBuffer(body)\n    ? new Buffer(body, encoding)\n    : body;\n\n  return etag(buf, {weak: false});\n};\n\n/**\n * Return weak ETag for `body`.\n *\n * @param {String|Buffer} body\n * @param {String} [encoding]\n * @return {String}\n * @api private\n */\n\nexports.wetag = function wetag(body, encoding){\n  var buf = !Buffer.isBuffer(body)\n    ? new Buffer(body, encoding)\n    : body;\n\n  return etag(buf, {weak: true});\n};\n\n/**\n * Check if `path` looks absolute.\n *\n * @param {String} path\n * @return {Boolean}\n * @api private\n */\n\nexports.isAbsolute = function(path){\n  if ('/' === path[0]) return true;\n  if (':' === path[1] && ('\\\\' === path[2] || '/' === path[2])) return true; // Windows device path\n  if ('\\\\\\\\' === path.substring(0, 2)) return true; // Microsoft Azure absolute path\n};\n\n/**\n * Flatten the given `arr`.\n *\n * @param {Array} arr\n * @return {Array}\n * @api private\n */\n\nexports.flatten = deprecate.function(flatten,\n  'utils.flatten: use array-flatten npm module instead');\n\n/**\n * Normalize the given `type`, for example \"html\" becomes \"text/html\".\n *\n * @param {String} type\n * @return {Object}\n * @api private\n */\n\nexports.normalizeType = function(type){\n  return ~type.indexOf('/')\n    ? acceptParams(type)\n    : { value: mime.lookup(type), params: {} };\n};\n\n/**\n * Normalize `types`, for example \"html\" becomes \"text/html\".\n *\n * @param {Array} types\n * @return {Array}\n * @api private\n */\n\nexports.normalizeTypes = function(types){\n  var ret = [];\n\n  for (var i = 0; i < types.length; ++i) {\n    ret.push(exports.normalizeType(types[i]));\n  }\n\n  return ret;\n};\n\n/**\n * Generate Content-Disposition header appropriate for the filename.\n * non-ascii filenames are urlencoded and a filename* parameter is added\n *\n * @param {String} filename\n * @return {String}\n * @api private\n */\n\nexports.contentDisposition = deprecate.function(contentDisposition,\n  'utils.contentDisposition: use content-disposition npm module instead');\n\n/**\n * Parse accept params `str` returning an\n * object with `.value`, `.quality` and `.params`.\n * also includes `.originalIndex` for stable sorting\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction acceptParams(str, index) {\n  var parts = str.split(/ *; */);\n  var ret = { value: parts[0], quality: 1, params: {}, originalIndex: index };\n\n  for (var i = 1; i < parts.length; ++i) {\n    var pms = parts[i].split(/ *= */);\n    if ('q' === pms[0]) {\n      ret.quality = parseFloat(pms[1]);\n    } else {\n      ret.params[pms[0]] = pms[1];\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compile \"etag\" value to function.\n *\n * @param  {Boolean|String|Function} val\n * @return {Function}\n * @api private\n */\n\nexports.compileETag = function(val) {\n  var fn;\n\n  if (typeof val === 'function') {\n    return val;\n  }\n\n  switch (val) {\n    case true:\n      fn = exports.wetag;\n      break;\n    case false:\n      break;\n    case 'strong':\n      fn = exports.etag;\n      break;\n    case 'weak':\n      fn = exports.wetag;\n      break;\n    default:\n      throw new TypeError('unknown value for etag function: ' + val);\n  }\n\n  return fn;\n}\n\n/**\n * Compile \"query parser\" value to function.\n *\n * @param  {String|Function} val\n * @return {Function}\n * @api private\n */\n\nexports.compileQueryParser = function compileQueryParser(val) {\n  var fn;\n\n  if (typeof val === 'function') {\n    return val;\n  }\n\n  switch (val) {\n    case true:\n      fn = querystring.parse;\n      break;\n    case false:\n      fn = newObject;\n      break;\n    case 'extended':\n      fn = parseExtendedQueryString;\n      break;\n    case 'simple':\n      fn = querystring.parse;\n      break;\n    default:\n      throw new TypeError('unknown value for query parser function: ' + val);\n  }\n\n  return fn;\n}\n\n/**\n * Compile \"proxy trust\" value to function.\n *\n * @param  {Boolean|String|Number|Array|Function} val\n * @return {Function}\n * @api private\n */\n\nexports.compileTrust = function(val) {\n  if (typeof val === 'function') return val;\n\n  if (val === true) {\n    // Support plain true/false\n    return function(){ return true };\n  }\n\n  if (typeof val === 'number') {\n    // Support trusting hop count\n    return function(a, i){ return i < val };\n  }\n\n  if (typeof val === 'string') {\n    // Support comma-separated values\n    val = val.split(/ *, */);\n  }\n\n  return proxyaddr.compile(val || []);\n}\n\n/**\n * Set the charset in a given Content-Type string.\n *\n * @param {String} type\n * @param {String} charset\n * @return {String}\n * @api private\n */\n\nexports.setCharset = function setCharset(type, charset) {\n  if (!type || !charset) {\n    return type;\n  }\n\n  // parse type\n  var parsed = contentType.parse(type);\n\n  // set charset\n  parsed.parameters.charset = charset;\n\n  // format type\n  return contentType.format(parsed);\n};\n\n/**\n * Parse an extended query string with qs.\n *\n * @return {Object}\n * @private\n */\n\nfunction parseExtendedQueryString(str) {\n  return qs.parse(str, {\n    allowPrototypes: true\n  });\n}\n\n/**\n * Return new empty object.\n *\n * @return {Object}\n * @api private\n */\n\nfunction newObject() {\n  return {};\n}\n"]}