{"version":3,"sources":["sockjs.js"],"names":[],"mappings":"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","file":"sockjs-compiled.js","sourcesContent":["// Generated by CoffeeScript 1.9.3\n(function() {\n  var App, Listener, Server, chunking_test, events, fs, generate_dispatcher, iframe, sockjsVersion, trans_eventsource, trans_htmlfile, trans_jsonp, trans_websocket, trans_xhr, utils, webjs,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty,\n    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  events = require('events');\n\n  fs = require('fs');\n\n  webjs = require('./webjs');\n\n  utils = require('./utils');\n\n  trans_websocket = require('./trans-websocket');\n\n  trans_jsonp = require('./trans-jsonp');\n\n  trans_xhr = require('./trans-xhr');\n\n  iframe = require('./iframe');\n\n  trans_eventsource = require('./trans-eventsource');\n\n  trans_htmlfile = require('./trans-htmlfile');\n\n  chunking_test = require('./chunking-test');\n\n  sockjsVersion = function() {\n    var pkg, x;\n    try {\n      pkg = fs.readFileSync(__dirname + '/../package.json', 'utf-8');\n    } catch (_error) {\n      x = _error;\n    }\n    if (pkg) {\n      return JSON.parse(pkg).version;\n    } else {\n      return null;\n    }\n  };\n\n  App = (function(superClass) {\n    extend(App, superClass);\n\n    function App() {\n      return App.__super__.constructor.apply(this, arguments);\n    }\n\n    App.prototype.welcome_screen = function(req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(200);\n      res.end(\"Welcome to SockJS!\\n\");\n      return true;\n    };\n\n    App.prototype.handle_404 = function(req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(404);\n      res.end('404 Error: Page not found\\n');\n      return true;\n    };\n\n    App.prototype.disabled_transport = function(req, res, data) {\n      return this.handle_404(req, res, data);\n    };\n\n    App.prototype.h_sid = function(req, res, data) {\n      var jsid;\n      req.cookies = utils.parseCookie(req.headers.cookie);\n      if (typeof this.options.jsessionid === 'function') {\n        this.options.jsessionid(req, res);\n      } else if (this.options.jsessionid && res.setHeader) {\n        jsid = req.cookies['JSESSIONID'] || 'dummy';\n        res.setHeader('Set-Cookie', 'JSESSIONID=' + jsid + '; path=/');\n      }\n      return data;\n    };\n\n    App.prototype.log = function(severity, line) {\n      return this.options.log(severity, line);\n    };\n\n    return App;\n\n  })(webjs.GenericApp);\n\n  utils.objectExtend(App.prototype, iframe.app);\n\n  utils.objectExtend(App.prototype, chunking_test.app);\n\n  utils.objectExtend(App.prototype, trans_websocket.app);\n\n  utils.objectExtend(App.prototype, trans_jsonp.app);\n\n  utils.objectExtend(App.prototype, trans_xhr.app);\n\n  utils.objectExtend(App.prototype, trans_eventsource.app);\n\n  utils.objectExtend(App.prototype, trans_htmlfile.app);\n\n  generate_dispatcher = function(options) {\n    var opts_filters, p, prefix_dispatcher, t, transport_dispatcher;\n    p = (function(_this) {\n      return function(s) {\n        return new RegExp('^' + options.prefix + s + '[/]?$');\n      };\n    })(this);\n    t = (function(_this) {\n      return function(s) {\n        return [p('/([^/.]+)/([^/.]+)' + s), 'server', 'session'];\n      };\n    })(this);\n    opts_filters = function(options_filter) {\n      if (options_filter == null) {\n        options_filter = 'xhr_options';\n      }\n      return ['h_sid', 'xhr_cors', 'cache_for', options_filter, 'expose'];\n    };\n    prefix_dispatcher = [['GET', p(''), ['welcome_screen']], ['GET', p('/iframe[0-9-.a-z_]*.html'), ['iframe', 'cache_for', 'expose']], ['OPTIONS', p('/info'), opts_filters('info_options')], ['GET', p('/info'), ['xhr_cors', 'h_no_cache', 'info', 'expose']], ['OPTIONS', p('/chunking_test'), opts_filters()], ['POST', p('/chunking_test'), ['xhr_cors', 'expect_xhr', 'chunking_test']]];\n    transport_dispatcher = [['GET', t('/jsonp'), ['h_sid', 'h_no_cache', 'jsonp']], ['POST', t('/jsonp_send'), ['h_sid', 'h_no_cache', 'expect_form', 'jsonp_send']], ['POST', t('/xhr'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_poll']], ['OPTIONS', t('/xhr'), opts_filters()], ['POST', t('/xhr_send'), ['h_sid', 'h_no_cache', 'xhr_cors', 'expect_xhr', 'xhr_send']], ['OPTIONS', t('/xhr_send'), opts_filters()], ['POST', t('/xhr_streaming'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_streaming']], ['OPTIONS', t('/xhr_streaming'), opts_filters()], ['GET', t('/eventsource'), ['h_sid', 'h_no_cache', 'eventsource']], ['GET', t('/htmlfile'), ['h_sid', 'h_no_cache', 'htmlfile']]];\n    if (options.websocket) {\n      prefix_dispatcher.push(['GET', p('/websocket'), ['raw_websocket']]);\n      transport_dispatcher.push(['GET', t('/websocket'), ['sockjs_websocket']]);\n    } else {\n      prefix_dispatcher.push(['GET', p('/websocket'), ['cache_for', 'disabled_transport']]);\n      transport_dispatcher.push(['GET', t('/websocket'), ['cache_for', 'disabled_transport']]);\n    }\n    return prefix_dispatcher.concat(transport_dispatcher);\n  };\n\n  Listener = (function() {\n    function Listener(options1, emit) {\n      this.options = options1;\n      this.handler = bind(this.handler, this);\n      this.app = new App();\n      this.app.options = this.options;\n      this.app.emit = emit;\n      this.app.log('debug', 'SockJS v' + sockjsVersion() + ' ' + 'bound to ' + JSON.stringify(this.options.prefix));\n      this.dispatcher = generate_dispatcher(this.options);\n      this.webjs_handler = webjs.generateHandler(this.app, this.dispatcher);\n      this.path_regexp = new RegExp('^' + this.options.prefix + '([/].+|[/]?)$');\n    }\n\n    Listener.prototype.handler = function(req, res, extra) {\n      if (!req.url.match(this.path_regexp)) {\n        return false;\n      }\n      this.webjs_handler(req, res, extra);\n      return true;\n    };\n\n    Listener.prototype.getHandler = function() {\n      return (function(_this) {\n        return function(a, b, c) {\n          return _this.handler(a, b, c);\n        };\n      })(this);\n    };\n\n    return Listener;\n\n  })();\n\n  Server = (function(superClass) {\n    extend(Server, superClass);\n\n    function Server(user_options) {\n      this.options = {\n        prefix: '',\n        response_limit: 128 * 1024,\n        websocket: true,\n        faye_server_options: null,\n        jsessionid: false,\n        heartbeat_delay: 25000,\n        disconnect_delay: 5000,\n        log: function(severity, line) {\n          return console.log(line);\n        },\n        sockjs_url: 'https://cdn.jsdelivr.net/sockjs/1.0.1/sockjs.min.js'\n      };\n      if (user_options) {\n        utils.objectExtend(this.options, user_options);\n      }\n    }\n\n    Server.prototype.listener = function(handler_options) {\n      var options;\n      options = utils.objectExtend({}, this.options);\n      if (handler_options) {\n        utils.objectExtend(options, handler_options);\n      }\n      return new Listener(options, (function(_this) {\n        return function() {\n          return _this.emit.apply(_this, arguments);\n        };\n      })(this));\n    };\n\n    Server.prototype.installHandlers = function(http_server, handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      utils.overshadowListeners(http_server, 'request', handler);\n      utils.overshadowListeners(http_server, 'upgrade', handler);\n      return true;\n    };\n\n    Server.prototype.middleware = function(handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      handler.upgrade = handler;\n      return handler;\n    };\n\n    return Server;\n\n  })(events.EventEmitter);\n\n  exports.createServer = function(options) {\n    return new Server(options);\n  };\n\n  exports.listen = function(http_server, options) {\n    var srv;\n    srv = exports.createServer(options);\n    if (http_server) {\n      srv.installHandlers(http_server);\n    }\n    return srv;\n  };\n\n}).call(this);\n"]}